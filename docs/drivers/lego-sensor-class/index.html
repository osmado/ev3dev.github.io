
<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>LEGO Sensor Class</title>
    
    <!-- Description content not available -->
    
    <link rel="alternate" type="application/atom+xml" href="/ev3dev.github.io/news/atom.xml" title="Atom feed">
    <link rel="icon" href="/ev3dev.github.io/favicon.ico" />

    <!-- Bootstrap styles -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/ev3dev.github.io/stylesheets/bootstrap.css">

    <!-- Custom styles -->
    <link rel="stylesheet" href="/ev3dev.github.io/stylesheets/site-structure.css">
    <link rel="stylesheet" href="/ev3dev.github.io/stylesheets/landing-content.css">

    <!-- Template for search results -->
    <script type="text/html" id="search-result-template">
        <div class="search-result">
            <a data-href="href"><h4 data-content="title"></h4></a>
            <span data-content="breadcrumbs" class="search-result-breadcrumbs"></span>
            <span data-content="author" class="search-result-author"></span><br/>
        </div>
    </script>

    

    
        <!-- Google Analytics excluded: not an official site build -->
    
</head>


<body class="no-jumbotron ">

    <div id="header">
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container-fluid container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" aria-expanded="false">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/ev3dev.github.io/">
                    <img id="brand-logo" src="/ev3dev.github.io/images/ev3dev_logo_white.png" alt="ev3dev logo" />
                </a>
            </div>
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav" id="main-nav">
                    <li>
                        <a href="/ev3dev.github.io/docs/getting-started" title="Our Getting Started guide">Start Here</a>
                    </li>
                    <li>
                        <a href="/ev3dev.github.io/download" title="SD card images for ev3dev">Downloads</a>
                    </li>
                    <li class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" title="Documentation on using ev3dev">
                            Documentation
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="/ev3dev.github.io/docs/tutorials">Tutorials</a>
                            </li>
                            <li>
                                <a href="/ev3dev.github.io/docs/programming-languages">Programming Languages</a>
                            </li>
                            <li>
                                <a href="/ev3dev.github.io/docs/networking">Networking</a>
                            </li>
                            <li>
                                <a href="/ev3dev.github.io/docs/driver-overview">Hardware Drivers</a>
                            </li>
                            <li role="separator" class="divider"></li>
                            <li>
                                <a href="/ev3dev.github.io/docs">More...</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="/ev3dev.github.io/support" title="Get Help with ev3dev">Support</a>
                    </li>
                    <li>
                        <a href="/ev3dev.github.io/news" title="ev3dev news">News</a>
                    </li>
                    <li class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                            Community
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="/ev3dev.github.io/contribute" title="How to contribute to ev3dev">Contribute</a>
                            </li>
                            <li>
                                <a href="/ev3dev.github.io/share" title="Share the word on ev3dev with others">Share</a>
                            </li>
                            <li>
                                <a href="/ev3dev.github.io/projects" title="Discover projects that use ev3dev">Project showcase</a>
                            </li>
                        </ul>
                    </li>
                </ul>
                <!-- items below float right, so appear in reverse order -->
                <div id="search-container">
                    <form class="navbar-form navbar-right dropdown" onsubmit="return false;">
                        <input type="text" id="search-input" class="form-control" placeholder="Quick nav" autocomplete="off" />
                        <div class="dropdown-menu" id="search-dropdown">
                            <div class="search-results-container" id="search-no-data-warning">
                                <span class="glyphicon glyphicon-alert heading-icon" aria-hidden="true"></span>
                                We were unable to retrieve search data from the
                                server. Make sure that JavaScript is enabled and
                                that nothing is blocking network access.
                            </div>

                            <div class="search-results-container" id="search-results-docs">
                                <h2>In docs</h2>
                                <div data-content="docs-results">
                                    <div class="no-results-note">No results</div>
                                </div>
                            </div>

                            <div class="search-results-container" id="search-results-projects">
                                <h2>In projects</h2>
                                <div data-content="project-results">
                                    <div class="no-results-note">No results</div>
                                </div>
                            </div>

                            <div class="search-results-container" id="search-results-news">
                                <h2>In news</h2>
                                <div data-content="news-results">
                                    <div class="no-results-note">No results</div>
                                </div>
                            </div>

                            <div class="search-results-container" id="search-results-misc">
                                <h2>In other pages</h2>
                                <div data-content="misc-results">
                                    <div class="no-results-note">No results</div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </nav>
</div>

    
    
    <div class="container">
        

<div class="page-header">
    
        <a class="btn btn-primary pull-right" href="https://github.com/ev3dev/lego-linux-drivers/edit/master/sensors/lego_sensor_class.c"><span class="glyphicon glyphicon-pencil"></span> Edit on Github</a>
    
    <h1>
        LEGO Sensor Class
        <small></small>
    </h1>
</div>
    </div>
    
    
    <div class="container">
    
        

<hr />
<div class="nav-dropdown-arrow">
    <div>
        

<ol class="breadcrumb" vocab="http://schema.org" typeof="BreadcrumbList">
    
    

    
        

        
        

        <li property="itemListElement" typeof="ListItem" class="">
            <a href="/ev3dev.github.io/docs/" property="item" typeof="WebPage">
                <span property="name">Documentation</span>
            </a>
            <meta property="position" content="1">
        </li>
        
    
        

        
        

        <li property="itemListElement" typeof="ListItem" class="">
            <a href="/ev3dev.github.io/docs/drivers/" property="item" typeof="WebPage">
                <span property="name">Kernel Drivers</span>
            </a>
            <meta property="position" content="2">
        </li>
        
    
        

        
        

        <li property="itemListElement" typeof="ListItem" class="active">
            <span href="/ev3dev.github.io/docs/drivers/" property="item" typeof="WebPage">
                <span property="name">LEGO Sensor Class</span>
            </span>
            <meta property="position" content="3">
        </li>
        
    
</ol>
    </div>
    
        <div class="alert alert-info">
            <span class="glyphicon glyphicon-info-sign " aria-hidden="true"></span>
            This docs page is for kernel version <code>4.4.44-18-ev3dev-ev3</code>
        </div>
    
</div>
<hr />



<p>The <code class="highlighter-rouge">lego-sensor</code> class provides a uniform interface for using most of the
sensors available for the EV3. The various underlying device drivers will
create a <code class="highlighter-rouge">lego-sensor</code> device for interacting with the sensors.</p>

<p>Sensors are primarily controlled by setting the <code class="highlighter-rouge">mode</code> and monitored by
reading the <code class="highlighter-rouge">value&lt;N&gt;</code> attributes. Values can be converted to floating point
if needed by <code class="highlighter-rouge">value&lt;N&gt;</code> / 10.0 ^ <code class="highlighter-rouge">decimals</code>.</p>

<h3 id="identifying-sensors">Identifying sensors</h3>

<p>Since the name of the <code class="highlighter-rouge">sensor&lt;N&gt;</code> device node does not correspond to the port
that a sensor is plugged in to, you must look at the <code class="highlighter-rouge">address</code> attribute if
you need to know which port a sensor is plugged in to. However, if you don’t
have more than one sensor of each type, you can just look for a matching
<code class="highlighter-rouge">driver_name</code>. Then it will not matter which port a sensor is plugged in to - your
program will still work.</p>

<h3 id="sysfs-attributes">sysfs Attributes</h3>

<p>Sensors can be found at <code class="highlighter-rouge">/sys/class/lego-sensor/sensor&lt;N&gt;</code>, where <code class="highlighter-rouge">&lt;N&gt;</code> is
incremented each time a sensor is loaded (it is not related to which port
the sensor is plugged in to).</p>

<dl>
  <dt><code class="highlighter-rouge">address</code></dt>
  <dd>(read-only) Returns the name of the port that the sensor is connected to,
e.g. <code class="highlighter-rouge">in1</code>. I2C sensors also include the I2C address (decimal), e.g.
<code class="highlighter-rouge">in1:i2c8</code>.</dd>
  <dt><code class="highlighter-rouge">bin_data</code></dt>
  <dd>(read-only) Reading the file will give the unscaled raw values in the
<code class="highlighter-rouge">value&lt;N&gt;</code> attributes. Use <code class="highlighter-rouge">bin_data_format</code>, <code class="highlighter-rouge">num_values</code> and the
individual sensor documentation to determine how to interpret the data.</dd>
  <dt><code class="highlighter-rouge">bin_data_format</code></dt>
  <dd>(read-only) Returns the format of the values in <code class="highlighter-rouge">bin_data</code> for the current
mode. Possible values are:

    <ul>
      <li><code class="highlighter-rouge">u8</code>: Unsigned 8-bit integer (byte)</li>
      <li><code class="highlighter-rouge">s8</code>: Signed 8-bit integer (sbyte)</li>
      <li><code class="highlighter-rouge">u16</code>: Unsigned 16-bit integer (ushort)</li>
      <li><code class="highlighter-rouge">s16</code>: Signed 16-bit integer (short)</li>
      <li><code class="highlighter-rouge">s16_be</code>: Signed 16-bit integer, big endian</li>
      <li><code class="highlighter-rouge">s32</code>: Signed 32-bit integer (int)</li>
      <li><code class="highlighter-rouge">s32_be</code>: Signed 32-bit integer, big endian</li>
      <li><code class="highlighter-rouge">float</code>: IEEE 754 32-bit floating point (float)</li>
    </ul>
  </dd>
  <dt><code class="highlighter-rouge">command</code></dt>
  <dd>(write-only) Sends a command to the sensor. See the individual sensor
documentation for possible commands. Sensors that do not support commands
will return <code class="highlighter-rouge">-EOPNOTSUPP</code> when writing to this attribute.</dd>
  <dt><code class="highlighter-rouge">commands</code></dt>
  <dd>(read-only) Returns a space separated list of the valid commands for the
sensor. Returns <code class="highlighter-rouge">-EOPNOTSUPP</code> if no commands are supported.</dd>
  <dt><code class="highlighter-rouge">direct</code></dt>
  <dd>(read/write) Allows direct communication with the sensor for using advanced
features that are not otherwise available through the lego-sensor class.
Returns <code class="highlighter-rouge">-EOPNOTSUPP</code> if the sensor does not support this. Currently this
only works with I2C sensors. For I2C sensors, use <code class="highlighter-rouge">seek</code> to set the register
to read or write from, then read or write the number of bytes required.</dd>
  <dt><code class="highlighter-rouge">decimals</code></dt>
  <dd>(read-only) Returns the number of decimal places for the values in the
<code class="highlighter-rouge">value&lt;N&gt;</code> attributes of the current mode.</dd>
  <dt><code class="highlighter-rouge">driver_name</code></dt>
  <dd>(read-only) Returns the name of the sensor device/driver. See the list of
<a href="/ev3dev.github.io/docs/sensors#supported-sensors">supported sensors</a> for a complete list of drivers.</dd>
  <dt><code class="highlighter-rouge">fw_version</code></dt>
  <dd>(read-only) Returns the firmware version of the sensor if available.
Currently only NXT/I2C sensors support this.</dd>
  <dt><code class="highlighter-rouge">mode</code></dt>
  <dd>(read/write) Returns the current mode. Writing one of the values returned
by <code class="highlighter-rouge">modes</code> sets the sensor to that mode. See the individual sensor
documentation for a description of the modes available for each type of
sensor.</dd>
  <dt><code class="highlighter-rouge">modes</code></dt>
  <dd>(read-only) Returns a space separated list of the valid modes for the sensor.</dd>
  <dt><code class="highlighter-rouge">num_values</code></dt>
  <dd>(read-only) Returns the number of <code class="highlighter-rouge">value&lt;N&gt;</code> attributes that will return
a valid value for the current mode.</dd>
  <dt><code class="highlighter-rouge">poll_ms</code></dt>
  <dd>(read/write) Returns the polling period of the sensor in milliseconds.
Writing sets the polling period. Setting to 0 disables polling. Returns
<code class="highlighter-rouge">-EOPNOTSUPP</code> if changing polling is not supported. Note: Setting <code class="highlighter-rouge">poll_ms</code>
too high can cause the input port autodetection to fail. If this happens,
use the <code class="highlighter-rouge">mode</code> attribute of the port to force the port to nxt-i2c mode.
Values must not be negative.</dd>
  <dt><code class="highlighter-rouge">units</code></dt>
  <dd>(read-only) Returns the units of the measured value for the current mode.
May return empty string if units are unknown.</dd>
  <dt><code class="highlighter-rouge">value&lt;N&gt;</code></dt>
  <dd>(read-only) Returns the value or values measured by the sensor. Check
<code class="highlighter-rouge">num_values</code> to see how many values there are. Values with N &gt;= num_values
will return an error. The values are fixed point numbers, so check
<code class="highlighter-rouge">decimals</code> to see if you need to divide to get the actual value.</dd>
  <dt><code class="highlighter-rouge">text_value</code></dt>
  <dd>(read-only) Returns a space delimited string representing sensor-specific
text values. Returns <code class="highlighter-rouge">-EOPNOTSUPP</code> if a sensor does not support text values.</dd>
</dl>

<h3 id="events">Events</h3>

<p>In addition to the usual “add” and “remove” events, the kernel “change”
event is emitted when <code class="highlighter-rouge">mode</code> or <code class="highlighter-rouge">poll_ms</code> is changed. The <code class="highlighter-rouge">value&lt;N&gt;</code>
attributes change too rapidly to be handled this way and therefore do not
trigger any uevents.</p>


    
    </div>
    
    <div id="footer">

        <div class="cclicense">
    
            <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">
                www.ev3dev.org (with the exception of the projects pages)
            </span>
            is licensed under
            <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
                <img alt="Creative Commons License" style="border-width:0" src="https://licensebuttons.net/l/by-sa/4.0/80x15.png" />
            </a>.
            <br />
            You are free to copy the text and images, but please be courteous and acknowledge the source.
    
        </div>

    <br />
    <div class="container">
        <span>
            Project maintained by <a href="https://github.com/rhempel">Ralph Hempel</a>
            and <a href="https://github.com/dlech">David Lechner</a>, with help from the community
        </span>
    </div>
</div>

    

<!-- Custom styles -->
<link rel="stylesheet" href="/ev3dev.github.io/stylesheets/search.css">
<link rel="stylesheet" href="/ev3dev.github.io/stylesheets/page-content.css">
<link rel="stylesheet" href="/ev3dev.github.io/stylesheets/user-cards.css">
<link rel="stylesheet" href="/ev3dev.github.io/stylesheets/tabs.css">

<!-- Python code highlighting -->
<link rel="stylesheet" href="/ev3dev.github.io/stylesheets/pygments/monokai.css" />

<!-- 3rd-party libraries -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
<script src="/ev3dev.github.io/javascripts/bootstrap/bootstrap.min.js"></script>
<script src="/ev3dev.github.io/javascripts/jquery.getUrlParam.js"></script>
<script src="/ev3dev.github.io/javascripts/jquery.loadTemplate-1.4.4.min.js"></script>
<script src="/ev3dev.github.io/javascripts/respond.js"></script>
<script src="/ev3dev.github.io/javascripts/ua-parser.min.js"></script>
<script src="https://unpkg.com/imagesloaded@4.1/imagesloaded.pkgd.min.js"></script>


<!-- Caches data from requests to API endpoints -->
<script src="/ev3dev.github.io/javascripts/api-cache.js"></script>
<!-- Loads user-cards from GH API -->
<script src="/ev3dev.github.io/javascripts/cards.js"></script>
<!-- Configures special anchors to link to the most recent ev3dev release -->
<script src="/ev3dev.github.io/javascripts/releases.js"></script>
<!-- Responds to queries typed into the "Quick nav" box -->
<script src="/ev3dev.github.io/javascripts/search.js"></script>
<!-- Converts static descriptors of tab target content into live text and links -->
<script src="/ev3dev.github.io/javascripts/tabs.js"></script>
<!-- Adds classes and other styles to pages where hard-coded css can't be used -->
<script src="/ev3dev.github.io/javascripts/style-helpers.js"></script>
</body>
</html>

