
<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ev3dev Linux Kernel</title>
    
    <!-- Description content not available -->
    
    <link rel="alternate" type="application/atom+xml" href="/ev3dev.github.io/news/atom.xml" title="Atom feed">
    <link rel="icon" href="/ev3dev.github.io/favicon.ico" />

    <!-- Bootstrap styles -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/ev3dev.github.io/stylesheets/bootstrap.css">

    <!-- Custom styles -->
    <link rel="stylesheet" href="/ev3dev.github.io/stylesheets/site-structure.css">
    <link rel="stylesheet" href="/ev3dev.github.io/stylesheets/landing-content.css">

    <!-- Template for search results -->
    <script type="text/html" id="search-result-template">
        <div class="search-result">
            <a data-href="href"><h4 data-content="title"></h4></a>
            <span data-content="breadcrumbs" class="search-result-breadcrumbs"></span>
            <span data-content="author" class="search-result-author"></span><br/>
        </div>
    </script>

    

    
        <!-- Google Analytics excluded: not an official site build -->
    
</head>


<body class="no-jumbotron ">

    <div id="header">
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container-fluid container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" aria-expanded="false">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/ev3dev.github.io/">
                    <img id="brand-logo" src="/ev3dev.github.io/images/ev3dev_logo_white.png" alt="ev3dev logo" />
                </a>
            </div>
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav" id="main-nav">
                    <li>
                        <a href="/ev3dev.github.io/docs/getting-started" title="Our Getting Started guide">Start Here</a>
                    </li>
                    <li>
                        <a href="/ev3dev.github.io/download" title="SD card images for ev3dev">Downloads</a>
                    </li>
                    <li class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" title="Documentation on using ev3dev">
                            Documentation
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="/ev3dev.github.io/docs/tutorials">Tutorials</a>
                            </li>
                            <li>
                                <a href="/ev3dev.github.io/docs/programming-languages">Programming Languages</a>
                            </li>
                            <li>
                                <a href="/ev3dev.github.io/docs/networking">Networking</a>
                            </li>
                            <li>
                                <a href="/ev3dev.github.io/docs/driver-overview">Hardware Drivers</a>
                            </li>
                            <li role="separator" class="divider"></li>
                            <li>
                                <a href="/ev3dev.github.io/docs">More...</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="/ev3dev.github.io/support" title="Get Help with ev3dev">Support</a>
                    </li>
                    <li>
                        <a href="/ev3dev.github.io/news" title="ev3dev news">News</a>
                    </li>
                    <li class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                            Community
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="/ev3dev.github.io/contribute" title="How to contribute to ev3dev">Contribute</a>
                            </li>
                            <li>
                                <a href="/ev3dev.github.io/share" title="Share the word on ev3dev with others">Share</a>
                            </li>
                            <li>
                                <a href="/ev3dev.github.io/projects" title="Discover projects that use ev3dev">Project showcase</a>
                            </li>
                        </ul>
                    </li>
                </ul>
                <!-- items below float right, so appear in reverse order -->
                <div id="search-container">
                    <form class="navbar-form navbar-right dropdown" onsubmit="return false;">
                        <input type="text" id="search-input" class="form-control" placeholder="Quick nav" autocomplete="off" />
                        <div class="dropdown-menu" id="search-dropdown">
                            <div class="search-results-container" id="search-no-data-warning">
                                <span class="glyphicon glyphicon-alert heading-icon" aria-hidden="true"></span>
                                We were unable to retrieve search data from the
                                server. Make sure that JavaScript is enabled and
                                that nothing is blocking network access.
                            </div>

                            <div class="search-results-container" id="search-results-docs">
                                <h2>In docs</h2>
                                <div data-content="docs-results">
                                    <div class="no-results-note">No results</div>
                                </div>
                            </div>

                            <div class="search-results-container" id="search-results-projects">
                                <h2>In projects</h2>
                                <div data-content="project-results">
                                    <div class="no-results-note">No results</div>
                                </div>
                            </div>

                            <div class="search-results-container" id="search-results-news">
                                <h2>In news</h2>
                                <div data-content="news-results">
                                    <div class="no-results-note">No results</div>
                                </div>
                            </div>

                            <div class="search-results-container" id="search-results-misc">
                                <h2>In other pages</h2>
                                <div data-content="misc-results">
                                    <div class="no-results-note">No results</div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </nav>
</div>

    
    
    <div class="container">
        

<div class="page-header">
    
        <a class="btn btn-primary pull-right" href="https://github.com/ev3dev/ev3dev.github.io/edit/master/docs/kernel-hackers-notebook/ev3dev-linux-kernel.md"><span class="glyphicon glyphicon-pencil"></span> Edit on Github</a>
    
    <h1>
        ev3dev Linux Kernel
        <small></small>
    </h1>
</div>
    </div>
    
    
    <div class="container">
    
        

<hr />
<div class="nav-dropdown-arrow">
    <div>
        

<ol class="breadcrumb" vocab="http://schema.org" typeof="BreadcrumbList">
    
    

    
        

        
        

        <li property="itemListElement" typeof="ListItem" class="">
            <a href="/ev3dev.github.io/docs/" property="item" typeof="WebPage">
                <span property="name">Documentation</span>
            </a>
            <meta property="position" content="1">
        </li>
        
    
        

        
        

        <li property="itemListElement" typeof="ListItem" class="">
            <a href="/ev3dev.github.io/docs/kernel-hackers-notebook/" property="item" typeof="WebPage">
                <span property="name">Kernel Hacker's Notebook</span>
            </a>
            <meta property="position" content="2">
        </li>
        
    
        

        
        

        <li property="itemListElement" typeof="ListItem" class="active">
            <span href="/ev3dev.github.io/docs/kernel-hackers-notebook/" property="item" typeof="WebPage">
                <span property="name">ev3dev Linux Kernel</span>
            </span>
            <meta property="position" content="3">
        </li>
        
    
</ol>
    </div>
    
</div>
<hr />



<p>The bleeding edge upstream development for linux-davinci is hosted at
<a href="https://git.kernel.org/cgit/linux/kernel/git/nsekhar/linux-davinci.git">kernel.org</a>.</p>

<p>The ev3dev kernel was originally based on <a href="http://processors.wiki.ti.com/index.php/DaVinci_PSP_03.22.00.02_Release_Notes">Davinci PSP 03.22.00.02</a> from TI.</p>

<h2 id="kernel-drivers">Kernel Drivers</h2>

<p>Most, if not all, of the customization of the ev3dev kernel is the addition and
patching of hardware drivers for the EV3 specific hardware. TODO: add more about
the ev3dev device driver philosophy - particularly in regard to attributes.</p>

<p>Be sure to check out the <a href="../index.html#hardware">hardware</a> pages for specifics on
how the drivers interface with the hardware.</p>

<h2 id="lms2012-sources">LMS2012 sources</h2>

<p>Most of the EV3 specific drivers are based on the source code for the official
LEGO firmware (aka LMS2012). The following table shows the relation of ev3dev
drivers to LMS2012 drivers.</p>

<table class="table table-striped table-bordered">
    <tr>
        <th>lms2012</th>
        <th>ev3dev</th>
        <th>Notes</th>
    </tr>
    <tr>
        <td rowspan="3"><a href="https://github.com/mindboards/ev3sources/blob/fea79c0e219cd5e43193ce2987b496e04758f3e2/lms2012/d_analog/Linuxmod_AM1808/d_analog.c">d_analog.c</a></td>
        <td><a href="https://github.com/ev3dev/lego-linux-drivers/blob/master/ev3/legoev3_analog.c">legoev3_analog.c</a></td>
        <td>Device1 portion of d_analog.c</td>
    </tr>
    <tr>
        <td><a href="https://github.com/ev3dev/lego-linux-drivers/blob/master/ev3/legoev3_ports_in.c">legoev3_ports_in.c</a></td>
        <td>Input portion of Device3</td>
    </tr>
    <tr>
        <td><a href="https://github.com/ev3dev/lego-linux-drivers/blob/master/ev3/legoev3_ports_out.c">legoev3_ports_out.c</a></td>
        <td>Output portion of Device3</td>
    </tr>
    <tr>
        <td><a href="https://github.com/mindboards/ev3sources/blob/7357369b6ebae4ee62001f3964f0f5fd0cce3c32/lms2012/d_bt/Linuxmod_AM1808/d_bt.c">d_bt.c</a></td>
        <td><a href="https://github.com/ev3dev/lego-linux-drivers/blob/master/ev3/legoev3_bluetooth.c">legoev3_bluetooth.c</a></td>
        <td>
            d_bt.c Device1 is not implemented yet
            <hr />Device2 is for firmware update, so is not needed in ev3dev
            <hr />"slow clock" comes from <a href="https://github.com/mindboards/ev3sources/blob/7357369b6ebae4ee62001f3964f0f5fd0cce3c32/extra/linux-03.20.00.13/arch/arm/mach-davinci/board-da850-evm.c">board-da850-evm.c</a> in the lms2012 kernel
        </td>
    </tr>
    <tr>
        <td><a href="https://github.com/mindboards/ev3sources/blob/7357369b6ebae4ee62001f3964f0f5fd0cce3c32/lms2012/d_iic/Linuxmod_AM1808/d_iic.c">d_iic.c</a></td>
        <td><a href="https://github.com/ev3dev/lego-linux-drivers/blob/master/ev3/legoev3_i2c.c">legoev3_i2c.c</a></td>
        <td>Using standard linux kernel i2c</td>
    </tr>
    <tr>
        <td><a href="https://github.com/mindboards/ev3sources/blob/7357369b6ebae4ee62001f3964f0f5fd0cce3c32/lms2012/d_power/Linuxmod_AM1808/d_power.c">d_power.c</a></td>
        <td><a href="https://github.com/ev3dev/lego-linux-drivers/blob/master/ev3/legoev3_battery.c">legoev3_battery.c</a></td>
        <td>ev3dev power off is done in <a href="https://github.com/ev3dev/ev3-kernel/blob/ev3dev-jessie/arch/arm/mach-davinci/board-legoev3.c">board-legoev3.c</a></td>
    </tr>
    <tr>
        <td rowspan="2"><a href="https://github.com/mindboards/ev3sources/blob/7357369b6ebae4ee62001f3964f0f5fd0cce3c32/lms2012/d_pwm/Linuxmod_AM1808/d_pwm.c">d_pwm.c</a></td>
        <td><a href="https://github.com/ev3dev/lego-linux-drivers/blob/master/ev3/legoev3_motor.c">legoev3_motor.c</a></td>
        <td></td>
    </tr>
    <tr>
        <td><a href="https://github.com/ev3dev/lego-linux-drivers/blob/master/motors/tacho_motor_class.c">tacho_motor_class.c</a></td>
        <td></td>
    </tr>
    <tr>
        <td><a href="https://github.com/mindboards/ev3sources/blob/7357369b6ebae4ee62001f3964f0f5fd0cce3c32/lms2012/d_sound/Linuxmod_AM1808/d_sound.c">d_sound.c</a></td>
        <td><a href="https://github.com/ev3dev/lego-linux-drivers/blob/master/ev3/legoev3_sound.c">legoev3_sound.c</a></td>
        <td>Implemented as a ALSA sound driver for PCM playback and an input device for tone playback</td>
    </tr>
    <tr>
        <td><a href="https://github.com/mindboards/ev3sources/blob/7357369b6ebae4ee62001f3964f0f5fd0cce3c32/lms2012/d_uart/Linuxmod_AM1808/d_uart_mod.c">d_uart_mod.c</a></td>
        <td></td>
        <td>Using standard kernel drivers for the SoC UARTs. Ported <a href="https://github.com/mindboards/ev3dev-kernel/tree/master/drivers/tty/serial/omapl_pru">omapl_pru</a> from LEGO firmware for PRU UARTs.</td>
    </tr>
    <tr>
        <td><a href="https://github.com/mindboards/ev3sources/blob/7357369b6ebae4ee62001f3964f0f5fd0cce3c32/lms2012/d_ui/Linuxmod_AM1808/d_ui.c">d_ui.c</a></td>
        <td></td>
        <td>Using standard kernel drivers, gpio-keys for buttons and leds-gpio for LEDs</td>
    </tr>
    <tr>
        <td><a href="https://github.com/mindboards/ev3sources/blob/7357369b6ebae4ee62001f3964f0f5fd0cce3c32/lms2012/d_usbdev/Linuxmod_AM1808/d_usbdev.c">d_usbdev.c</a></td>
        <td></td>
        <td>Probably won't implement something like this in ev3dev<hr />Using exiting USB gadget drivers</td>
    </tr>
    <tr>
        <td><a href="https://github.com/mindboards/ev3sources/blob/7357369b6ebae4ee62001f3964f0f5fd0cce3c32/lms2012/d_usbhost/Linuxmod_AM1808/d_usbhost.c">d_usbhost.c</a></td>
        <td></td>
        <td>Not implementing because it does not do anything</td>
    </tr>
    <tr>
        <th colspan="3">Kernel</th>
    </tr>
    <tr>
        <td><a href="https://github.com/mindboards/ev3sources/blob/7357369b6ebae4ee62001f3964f0f5fd0cce3c32/extra/linux-03.20.00.13/arch/arm/mach-davinci/board-da850-evm.c">board-da850-evm.c</a></td>
        <td><a href="https://github.com/ev3dev/ev3-kernel/blob/ev3dev-jessie/arch/arm/mach-davinci/board-legoev3.c">board-legoev3.c</a></td>
        <td></td>
    </tr>
    <tr>
        <td><a href="https://github.com/mindboards/ev3sources/blob/7357369b6ebae4ee62001f3964f0f5fd0cce3c32/extra/linux-03.20.00.13/arch/arm/mach-davinci/davinci-iic.c">davinci-iic.c</a></td>
        <td>[legoev3-fiq.c]</td>
        <td>lms2012 just uses this for i2c, ev3dev uses it for i2c and sound</td>
    </tr>
    <tr>
        <td><a href="https://github.com/mindboards/ev3sources/blob/7357369b6ebae4ee62001f3964f0f5fd0cce3c32/extra/linux-03.20.00.13/drivers/video/st7586fb.c">st7586fb.c</a></td>
        <td><a href="https://github.com/ev3dev/ev3-kernel/blob/ev3dev-jessie/drivers/video/st7586fb.c">st7586fb.c</a></td>
        <td></td>
    </tr>
</table>

<h2 id="where-to-find-stuff">Where to find stuff</h2>

<p>Most everything is in the <a href="https://github.com/ev3dev/lego-linux-drivers">lego-linux-drivers</a> repository nowadays.</p>


    
    </div>
    
    <div id="footer">

        <div class="cclicense">
    
            <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">
                www.ev3dev.org (with the exception of the projects pages)
            </span>
            is licensed under
            <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
                <img alt="Creative Commons License" style="border-width:0" src="https://licensebuttons.net/l/by-sa/4.0/80x15.png" />
            </a>.
            <br />
            You are free to copy the text and images, but please be courteous and acknowledge the source.
    
        </div>

    <br />
    <div class="container">
        <span>
            Project maintained by <a href="https://github.com/rhempel">Ralph Hempel</a>
            and <a href="https://github.com/dlech">David Lechner</a>, with help from the community
        </span>
    </div>
</div>

    

<!-- Custom styles -->
<link rel="stylesheet" href="/ev3dev.github.io/stylesheets/search.css">
<link rel="stylesheet" href="/ev3dev.github.io/stylesheets/page-content.css">
<link rel="stylesheet" href="/ev3dev.github.io/stylesheets/user-cards.css">
<link rel="stylesheet" href="/ev3dev.github.io/stylesheets/tabs.css">

<!-- Python code highlighting -->
<link rel="stylesheet" href="/ev3dev.github.io/stylesheets/pygments/monokai.css" />

<!-- 3rd-party libraries -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
<script src="/ev3dev.github.io/javascripts/bootstrap/bootstrap.min.js"></script>
<script src="/ev3dev.github.io/javascripts/jquery.getUrlParam.js"></script>
<script src="/ev3dev.github.io/javascripts/jquery.loadTemplate-1.4.4.min.js"></script>
<script src="/ev3dev.github.io/javascripts/respond.js"></script>
<script src="/ev3dev.github.io/javascripts/ua-parser.min.js"></script>
<script src="https://unpkg.com/imagesloaded@4.1/imagesloaded.pkgd.min.js"></script>


<!-- Caches data from requests to API endpoints -->
<script src="/ev3dev.github.io/javascripts/api-cache.js"></script>
<!-- Loads user-cards from GH API -->
<script src="/ev3dev.github.io/javascripts/cards.js"></script>
<!-- Configures special anchors to link to the most recent ev3dev release -->
<script src="/ev3dev.github.io/javascripts/releases.js"></script>
<!-- Responds to queries typed into the "Quick nav" box -->
<script src="/ev3dev.github.io/javascripts/search.js"></script>
<!-- Converts static descriptors of tab target content into live text and links -->
<script src="/ev3dev.github.io/javascripts/tabs.js"></script>
<!-- Adds classes and other styles to pages where hard-coded css can't be used -->
<script src="/ev3dev.github.io/javascripts/style-helpers.js"></script>
</body>
</html>

